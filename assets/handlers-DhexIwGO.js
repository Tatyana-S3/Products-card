import{a as y,i as I}from"./vendor-CUMZO5Rt.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();const x="https://dummyjson.com",_={CATEGORIES:"/products/category-list",PRODUCTS:"/products",PRODUCTS_ID:"/products/",SEARCH:"/products/search",PRODUCTS_CATEGORY:"/products/category/"},m={WISHLIST:"wishlist",CART:"cart",THEME:"theme"},g=12;y.defaults.baseURL=x;async function O(){return(await y.get(_.CATEGORIES)).data}async function k(e){const t={limit:g,skip:(e-1)*g};return(await y.get(_.PRODUCTS,{params:t})).data}async function W(e){return(await y.get(`${_.PRODUCTS_ID}${e}`)).data}async function F(e){const t={q:e};return(await y.get(_.SEARCH,{params:t})).data}async function D(e){return(await y.get(`${_.PRODUCTS_CATEGORY}${e}`)).data.products}const o={categoriesList:document.querySelector(".categories"),productsList:document.querySelector(".products"),categoriesBtn:document.querySelector(".categories__btn"),divNotFound:document.querySelector(".not-found"),loadMoreBtn:document.querySelector(".load-more-btn"),loader:document.querySelector(".loader"),darkThemeBtn:document.querySelector(".theme-toggle-btn"),modalWindow:document.querySelector(".modal"),modalCloseBtn:document.querySelector(".modal__close-btn"),modalProduct:document.querySelector(".modal-product"),modalCartBtn:document.querySelector(".modal-product__btn--cart"),modalWishlistBtn:document.querySelector(".modal-product__btn--wishlist"),searchForm:document.querySelector(".search-form"),searchClearBtn:document.querySelector(".search-form__btn-clear"),searchFormInput:document.querySelector(".search-form__input"),navCartCount:document.querySelector(".nav__count[data-cart-count]"),summaryCartCount:document.querySelector(".cart-summary__value[data-count]"),summaryTotalPrice:document.querySelector(".cart-summary__value[data-price]"),buyBtn:document.querySelector(".cart-summary__btn"),navWishlistCount:document.querySelector(".nav__count[data-wishlist-count]")};function U(e){const r=["All",...e].map(n=>`
        <li class="categories__item">
   <button class="categories__btn" type="button">${n}</button>
 </li>
            `).join("");o.categoriesList.insertAdjacentHTML("beforeend",r)}function j(e){const t=e.map(({id:r,thumbnail:n,description:a,title:s,brand:c,category:d,price:i})=>`
        <li class="products__item" data-id="${r}">
    <img class="products__image" src="${n}" alt="${a}"/>
    <p class="products__title">${s}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand:${c}</span></p>
    <p class="products__category">Category: ${d}</p>
    <p class="products__price">Price: ${i}$</p>
 </li>
            `).join("");o.productsList.insertAdjacentHTML("beforeend",t)}function G({id:e,thumbnail:t,description:r,title:n,returnPolicy:a,shippingInformation:s,price:c}){const d=`
  <img class="modal-product__img" src="${t}" alt="${r}" />
      <div class="modal-product__content" data-id='${e}'>
        <p class="modal-product__title">${n}</p>
        <ul class="modal-product__tags"></ul>
        <p class="modal-product__description">${r}</p>
        <p class="modal-product__shipping-information">Shipping:${s}</p>
        <p class="modal-product__return-policy">Return Policy:${a}</p>
        <p class="modal-product__price">Price:${c} $</p>

        <button class="modal-product__buy-btn" type="button" data-id="${e}">Buy</button>
      </div>
  `;o.modalProduct.innerHTML=d}function z(e){const t=e.map(({id:r,thumbnail:n,description:a,title:s,brand:c,category:d,price:i,quantity:u})=>{const b=(i*u).toFixed(2);return`<li class="products__item cart-item" data-id="${r}">
              <img class="products__image" src="${n}" alt="${a}"/>
              <div class="product__info">
                  <p class="products__title">${s}</p>
                  <p class="products__brand"><span class="products__brand--bold">Brand:${c}</span></p>
                  <p class="products__category">Category: ${d}</p>
                  <p class="products__price">Price: ${i}$</p>

                <p class="product-total-price">Total: 
                   <span class="total-price-value">${b}</span>$ 
                </p> 

              <div class="product__quantity-control" data-id="${r}" data-price="${i}">
                  <button type="button" class="quantity-btn" data-action="decrement">-</button>
                  <input type="number" class="quantity-input" value="${u}" min="1">
                  <button type="button" class="quantity-btn" data-action="increment">+</button>
              </div>

              </div>
          </li>
  `}).join("");o.productsList.innerHTML=t}function f(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(r){console.log("Error saving data to LocalStorege:",r.message)}}function q(e){try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.log(`Error getting data from LS: ${t.message}`),null}}function C(){return q(m.CART)||[]}function $(){return q(m.WISHLIST)||[]}function Y(){return q(m.THEME)}function J(){o.loadMoreBtn.classList.remove("is-hidden")}function N(){o.loadMoreBtn.classList.add("is-hidden")}function K(){o.loader.classList.add("visible")}function Q(){o.loader.classList.remove("visible")}function H(){Y()==="dark"?(document.body.setAttribute("data-theme","dark"),o.darkThemeBtn.innerHTML="&#9790;"):(document.body.removeAttribute("data-theme"),o.darkThemeBtn.innerHTML="&#9728;")}function V(){const e=document.querySelector(".products__item");if(e){const t=e.getBoundingClientRect().height;window.scrollBy({top:t*3,behavior:"smooth"})}}function E(){const t=C().length;o.navCartCount&&(o.navCartCount.textContent=t),o.summaryCartCount&&(o.summaryCartCount.textContent=t)}function T(){const t=$().length;o.navWishlistCount&&(o.navWishlistCount.textContent=t)}function B(e){const t=e.reduce((r,n)=>r+n.price*n.quantity,0);o.summaryTotalPrice.textContent=`$ ${t.toFixed(2)}`}function R(){o.modalWindow.classList.toggle("modal--is-open")}document.addEventListener("keydown",e=>{e.code==="Escape"&&R()});let p=[];document.querySelector(".js-cart-page")&&document.addEventListener("DOMContentLoaded",()=>{o.darkThemeBtn.addEventListener("click",tt),X()});async function X(){E(),T(),H();const t=C().filter(n=>n&&n.id&&!isNaN(Number(n.id)));f(m.CART,t);const r=!t||t.length===0;if(o.productsList.innerHTML="",r){o.divNotFound.classList.add("not-found--visible"),o.productsList.innerHTML='<p class="cart-empty-message">Your basket is empty.</p>',B([]);return}o.divNotFound.classList.remove("not-found--visible");try{const n=t.map(c=>W(Number(c.id)));p=(await Promise.all(n)).map(c=>{const d=t.find(i=>i.id===c.id);return{...c,quantity:d?d.quantity:1}}),z(p),B(p);const s=o.productsList.cloneNode(!0);o.productsList.parentNode.replaceChild(s,o.productsList),o.productsList=s,o.productsList.addEventListener("click",Z),o.productsList.addEventListener("click",productsListHandler),o.buyBtn.onclick=()=>et(p)}catch{I.error({message:"Error loading items in shopping cart!"})}}function Z(e){e.stopPropagation();const t=e.target,r=t.dataset.action;if(r!=="increment"&&r!=="decrement")return;const n=t.closest(".product__quantity-control");if(!n)return;const a=n.dataset.id,s=parseFloat(n.dataset.price),c=n.querySelector(".quantity-input"),i=t.closest(".cart-item").querySelector(".total-price-value");if(!c||isNaN(s))return;let u=parseInt(c.value);if(r==="increment")u+=1;else if(r==="decrement"&&u>1)u-=1;else return;let b=C();const w=b.find(v=>v.id==a);if(w){w.quantity=u,f(m.CART,b),c.value=u;const v=s*u;i&&!isNaN(v)&&(i.textContent=v.toFixed(2));const A=p.find(M=>M.id==a);A&&(A.quantity=u,B(p))}else I({message:"Error: item not found in shopping cart."})}let l=1,P=0,S="All",h="";async function L(){K(),o.divNotFound.classList.remove("not-found--visible");try{let e=[],t=0;const r=(l-1)*g,n=r+g;if(h){const a=await F(h);t=a.total,e=a.products.slice(r,n)}else if(S==="All"){const a=await k(l);t=a.total,e=a.products}else{const a=await D(S);t=a.length,e=a.slice(r,n)}if(l===1&&(o.productsList.innerHTML=""),!e||e.length===0){o.divNotFound.classList.add("not-found--visible"),N();return}P=Math.ceil(t/g),j(e),l>1&&V(),l<P?J():N()}catch{I.error({title:"Error",message:"Illegal operation"})}finally{Q()}}async function rt(){l++,await L()}function tt(){const e=document.body.hasAttribute("data-theme");let t;e?(document.body.removeAttribute("data-theme"),t="light"):(document.body.setAttribute("data-theme","dark"),t="dark"),f(m.THEME,t),o.darkThemeBtn.innerHTML=t==="dark"?"&#9790;":"&#9728;"}async function at(){H(),E(),T();try{const e=await O();U(e),l=1,S="All",await L()}catch(e){console.error("error initial home page",e)}}async function nt(e){if(e.target.tagName!=="BUTTON")return;o.categoriesList.querySelectorAll(".categories__btn").forEach(r=>{r.classList.remove("categories__btn--active")});try{const r=e.target;S=r.textContent.trim(),h="",l=1,P=0,r.classList.add("categories__btn--active"),o.productsList.innerHTML="",o.divNotFound.classList.remove("not-found--visible"),await L()}catch(r){console.log(r.message)}}async function st(e){if(e.target.closest("[data-action]"))return;const t=e.target.closest(".products__item");if(!t)return;o.modalCartBtn&&(o.modalCartBtn.style.display=""),o.modalWishlistBtn&&(o.modalWishlistBtn.style.display="");const r=t.dataset.id;try{const n=await W(r);G(n),R(),o.modalCartBtn.dataset.id=r,o.modalWishlistBtn.dataset.id=r;const s=C().some(i=>i.id===r),d=$().includes(r);s?o.modalCartBtn.textContent="Remove from cart":o.modalCartBtn.textContent="Add to cart",d?o.modalWishlistBtn.textContent="Remove from Wishlist":o.modalWishlistBtn.textContent="Add to Wishlist"}catch{I.error({message:"Error loading product"})}}async function ct(e){e.preventDefault();const t=o.searchFormInput.value.trim().toLowerCase();t&&(h=t,l=1,await L(),o.searchForm.reset())}async function it(){o.searchFormInput.value="",h="",l=1,await L()}async function dt(e){const t=e.target.dataset.id;if(!t)return;const r=C(),n=r.findIndex(a=>a.id===t);n===-1?(r.push({id:t,quantity:1}),o.modalCartBtn.textContent="Remove from cart"):(r.splice(n,1),o.modalCartBtn.textContent="Add to cart"),f(m.CART,r),E()}function et(e){openCheckoutModal(e)}async function ut(e){const t=e.target.dataset.id;if(!t)return;const r=$(),n=r.findIndex(a=>a===t);if(n===-1)r.push(t),f(m.WISHLIST,r),o.modalWishlistBtn.textContent="Remove from Wishlist",T();else if(r.splice(n,1),f(m.WISHLIST,r),o.modalWishlistBtn.textContent="Add to Wishlist",T(),o.productsList){const a=o.productsList.querySelector(`.products__item[data-id="${t}"]`);a&&(a.remove(),r.length===0&&o.divNotFound.classList.add("not-found--visible"))}}export{E as a,W as b,j as c,R as d,dt as e,ut as f,$ as g,at as h,H as i,nt as j,it as k,rt as l,st as p,o as r,ct as s,tt as t,T as u};
//# sourceMappingURL=handlers-DhexIwGO.js.map
