import{a as f,i as B}from"./vendor-CUMZO5Rt.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const x="https://dummyjson.com",_={CATEGORIES:"/products/category-list",PRODUCTS:"/products",PRODUCTS_ID:"/products/",SEARCH:"/products/search",PRODUCTS_CATEGORY:"/products/category/"},m={WISHLIST:"wishlist",CART:"cart",THEME:"theme"},y=12;f.defaults.baseURL=x;async function O(){return(await f.get(_.CATEGORIES)).data}async function k(t){const e={limit:y,skip:(t-1)*y};return(await f.get(_.PRODUCTS,{params:e})).data}async function H(t){return(await f.get(`${_.PRODUCTS_ID}${t}`)).data}async function F(t){const e={q:t};return(await f.get(_.SEARCH,{params:e})).data}async function D(t){return(await f.get(`${_.PRODUCTS_CATEGORY}${t}`)).data.products}const o={categoriesList:document.querySelector(".categories"),productsList:document.querySelector(".products"),categoriesBtn:document.querySelector(".categories__btn"),divNotFound:document.querySelector(".not-found"),loadMoreBtn:document.querySelector(".load-more-btn"),loader:document.querySelector(".loader"),darkThemeBtn:document.querySelector(".theme-toggle-btn"),modalWindow:document.querySelector(".modal"),modalCloseBtn:document.querySelector(".modal__close-btn"),modalProduct:document.querySelector(".modal-product"),modalCartBtn:document.querySelector(".modal-product__btn--cart"),modalWishlistBtn:document.querySelector(".modal-product__btn--wishlist"),searchForm:document.querySelector(".search-form"),searchClearBtn:document.querySelector(".search-form__btn-clear"),searchFormInput:document.querySelector(".search-form__input"),navCartCount:document.querySelector(".nav__count[data-cart-count]"),summaryCartCount:document.querySelector(".cart-summary__value[data-count]"),summaryTotalPrice:document.querySelector(".cart-summary__value[data-price]"),buyBtn:document.querySelector(".cart-summary__btn"),navWishlistCount:document.querySelector(".nav__count[data-wishlist-count]")};function U(t){const r=["All",...t].map(a=>`
        <li class="categories__item">
   <button class="categories__btn" type="button">${a}</button>
 </li>
            `).join("");o.categoriesList.insertAdjacentHTML("beforeend",r)}function j(t){const e=t.map(({id:r,thumbnail:a,description:n,title:s,brand:c,category:i,price:d})=>`
        <li class="products__item" data-id="${r}">
    <img class="products__image" src="${a}" alt="${n}"/>
    <p class="products__title">${s}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand:${c}</span></p>
    <p class="products__category">Category: ${i}</p>
    <p class="products__price">Price: ${d}$</p>
 </li>
            `).join("");o.productsList.insertAdjacentHTML("beforeend",e)}function G({id:t,thumbnail:e,description:r,title:a,returnPolicy:n,shippingInformation:s,price:c}){const i=`
  <img class="modal-product__img" src="${e}" alt="${r}" />
      <div class="modal-product__content" data-id='${t}'>
        <p class="modal-product__title">${a}</p>
        <ul class="modal-product__tags"></ul>
        <p class="modal-product__description">${r}</p>
        <p class="modal-product__shipping-information">Shipping:${s}</p>
        <p class="modal-product__return-policy">Return Policy:${n}</p>
        <p class="modal-product__price">Price:${c} $</p>

        <button class="modal-product__buy-btn" type="button" data-id="${t}">Buy</button>
      </div>
  `;o.modalProduct.innerHTML=i}function z(t){const e=t.map(({id:r,thumbnail:a,description:n,title:s,brand:c,category:i,price:d,quantity:u})=>{const b=(d*u).toFixed(2);return`<li class="products__item cart-item" data-id="${r}">
              <img class="products__image" src="${a}" alt="${n}"/>
              <div class="product__info">
                  <p class="products__title">${s}</p>
                  <p class="products__brand"><span class="products__brand--bold">Brand:${c}</span></p>
                  <p class="products__category">Category: ${i}</p>
                  <p class="products__price">Price: ${d}$</p>

                <p class="product-total-price">Total: 
                   <span class="total-price-value">${b}</span>$ 
                </p> 

              <div class="product__quantity-control" data-id="${r}" data-price="${d}">
                  <button type="button" class="quantity-btn" data-action="decrement">-</button>
                  <input type="number" class="quantity-input" value="${u}" min="1">
                  <button type="button" class="quantity-btn" data-action="increment">+</button>
              </div>

              </div>
          </li>
  `}).join("");o.productsList.innerHTML=e}function g(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(r){console.log("Error saving data to LocalStorege:",r.message)}}function q(t){try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch(e){return console.log(`Error getting data from LS: ${e.message}`),null}}function C(){return q(m.CART)||[]}function $(){return q(m.WISHLIST)||[]}function Y(){return q(m.THEME)}function J(){o.loadMoreBtn.classList.remove("is-hidden")}function W(){o.loadMoreBtn.classList.add("is-hidden")}function K(){o.loader.classList.add("visible")}function Q(){o.loader.classList.remove("visible")}function N(){Y()==="dark"?(document.body.setAttribute("data-theme","dark"),o.darkThemeBtn.innerHTML="&#9790;"):(document.body.removeAttribute("data-theme"),o.darkThemeBtn.innerHTML="&#9728;")}function V(){const t=document.querySelector(".products__item");if(t){const e=t.getBoundingClientRect().height;window.scrollBy({top:e*3,behavior:"smooth"})}}function E(){const e=C().length;o.navCartCount&&(o.navCartCount.textContent=e),o.summaryCartCount&&(o.summaryCartCount.textContent=e)}function S(){const e=$().length;o.navWishlistCount&&(o.navWishlistCount.textContent=e)}function I(t){const e=t.reduce((r,a)=>r+a.price*a.quantity,0);o.summaryTotalPrice.textContent=`$ ${e.toFixed(2)}`}function M(){o.modalWindow.classList.toggle("modal--is-open")}document.addEventListener("keydown",t=>{t.code==="Escape"&&M()});let p=[];document.querySelector(".js-cart-page")&&document.addEventListener("DOMContentLoaded",()=>{o.darkThemeBtn.addEventListener("click",tt),X()});async function X(){E(),S(),N();const t=C(),e=!t||t.length===0;if(o.productsList.innerHTML="",e){o.divNotFound.classList.add("not-found--visible"),o.productsList.innerHTML='<p class="cart-empty-message">Your basket is empty.</p>',I([]);return}o.divNotFound.classList.remove("not-found--visible");try{const r=t.map(s=>H(Number(s.id)));p=(await Promise.all(r)).map(s=>{const c=t.find(i=>i.id===s.id);return{...s,quantity:c?c.quantity:1}}),z(p),I(p);const n=o.productsList.cloneNode(!0);o.productsList.parentNode.replaceChild(n,o.productsList),o.productsList=n,o.productsList.addEventListener("click",Z),o.productsList.addEventListener("click",productsListHandler),o.buyBtn.onclick=()=>et(p)}catch{B.error({message:"Error loading items in shopping cart!"})}}function Z(t){t.stopPropagation();const e=t.target,r=e.dataset.action;if(r!=="increment"&&r!=="decrement")return;const a=e.closest(".product__quantity-control");if(!a)return;const n=a.dataset.id,s=parseFloat(a.dataset.price),c=a.querySelector(".quantity-input"),d=e.closest(".cart-item").querySelector(".total-price-value");if(!c||isNaN(s))return;let u=parseInt(c.value);if(r==="increment")u+=1;else if(r==="decrement"&&u>1)u-=1;else return;let b=C();const w=b.find(v=>v.id==n);if(w){w.quantity=u,g(m.CART,b),c.value=u;const v=s*u;d&&!isNaN(v)&&(d.textContent=v.toFixed(2));const A=p.find(R=>R.id==n);A&&(A.quantity=u,I(p))}else B({message:"Error: item not found in shopping cart."})}let l=1,P=0,T="All",h="";async function L(){K(),o.divNotFound.classList.remove("not-found--visible");try{let t=[],e=0;const r=(l-1)*y,a=r+y;if(h){const n=await F(h);e=n.total,t=n.products.slice(r,a)}else if(T==="All"){const n=await k(l);e=n.total,t=n.products}else{const n=await D(T);e=n.length,t=n.slice(r,a)}if(l===1&&(o.productsList.innerHTML=""),!t||t.length===0){o.divNotFound.classList.add("not-found--visible"),W();return}P=Math.ceil(e/y),j(t),l>1&&V(),l<P?J():W()}catch{B.error({title:"Error",message:"Illegal operation"})}finally{Q()}}async function rt(){l++,await L()}function tt(){const t=document.body.hasAttribute("data-theme");let e;t?(document.body.removeAttribute("data-theme"),e="light"):(document.body.setAttribute("data-theme","dark"),e="dark"),g(m.THEME,e),o.darkThemeBtn.innerHTML=e==="dark"?"&#9790;":"&#9728;"}async function nt(){N(),E(),S();try{const t=await O();U(t),l=1,T="All",await L()}catch(t){console.error("error initial home page",t)}}async function at(t){if(t.target.tagName!=="BUTTON")return;o.categoriesList.querySelectorAll(".categories__btn").forEach(r=>{r.classList.remove("categories__btn--active")});try{const r=t.target;T=r.textContent.trim(),h="",l=1,P=0,r.classList.add("categories__btn--active"),o.productsList.innerHTML="",o.divNotFound.classList.remove("not-found--visible"),await L()}catch(r){console.log(r.message)}}async function st(t){if(t.target.closest("[data-action]"))return;const e=t.target.closest(".products__item");if(!e)return;o.modalCartBtn&&(o.modalCartBtn.style.display=""),o.modalWishlistBtn&&(o.modalWishlistBtn.style.display="");const r=e.dataset.id;try{const a=await H(r);G(a),M(),o.modalCartBtn.dataset.id=r,o.modalWishlistBtn.dataset.id=r;const s=C().some(d=>d.id===r),i=$().includes(r);s?o.modalCartBtn.textContent="Remove from cart":o.modalCartBtn.textContent="Add to cart",i?o.modalWishlistBtn.textContent="Remove from Wishlist":o.modalWishlistBtn.textContent="Add to Wishlist"}catch{B.error({message:"Error loading product"})}}async function ct(t){t.preventDefault();const e=o.searchFormInput.value.trim().toLowerCase();e&&(h=e,l=1,await L(),o.searchForm.reset())}async function it(){o.searchFormInput.value="",h="",l=1,await L()}async function dt(t){const e=t.target.dataset.id;if(!e)return;const r=C(),a=r.findIndex(n=>n.id===e);a===-1?(r.push({id:e,quantity:1}),o.modalCartBtn.textContent="Remove from cart"):(r.splice(a,1),o.modalCartBtn.textContent="Add to cart"),g(m.CART,r),E()}function et(t){openCheckoutModal(t)}async function ut(t){const e=t.target.dataset.id;if(!e)return;const r=$(),a=r.findIndex(n=>n===e);if(a===-1)r.push(e),g(m.WISHLIST,r),o.modalWishlistBtn.textContent="Remove from Wishlist",S();else if(r.splice(a,1),g(m.WISHLIST,r),o.modalWishlistBtn.textContent="Add to Wishlist",S(),o.productsList){const n=o.productsList.querySelector(`.products__item[data-id="${e}"]`);n&&(n.remove(),r.length===0&&o.divNotFound.classList.add("not-found--visible"))}}export{E as a,H as b,j as c,M as d,dt as e,ut as f,$ as g,nt as h,N as i,at as j,it as k,rt as l,st as p,o as r,ct as s,tt as t,S as u};
//# sourceMappingURL=handlers-C5ZSeY_r.js.map
